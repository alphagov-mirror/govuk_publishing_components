@import "govuk/components/accordion/accordion";

$gem-c-accordion-border-width: 3px;
$gem-c-accordion-bottom-border-width: 2px;

// Buttons within the sections don’t need default styling
.gem-c-accordion__section-button {
  @include govuk-font($size: 24, $weight: bold);
  display: inline-block;
  margin-bottom: 0;
  padding-top: govuk-spacing(3);
}

.gem-c-accordion__section-header {
  padding-top: govuk-spacing(3);
  padding-bottom: govuk-spacing(3);
}

.js-enabled {
  .gem-c-accordion {

    border-bottom: $gem-c-accordion-bottom-border-width solid $govuk-border-colour;
  }

  .gem-c-accordion__controls {
    text-align: left;
  }

  .gem-c-accordion__open-all {

    position: relative;
    z-index: 1;
    border-width: 0;
    color: $govuk-link-colour;
    background: none;
    cursor: pointer;
    -webkit-appearance: none;
    margin: 0 0 govuk-spacing(4) 0;
    padding: 0 0 govuk-spacing(1) 0;

    @include govuk-font($size: 16);
    @include govuk-link-common;
    @include govuk-link-style-default;

    // Remove default button focus outline in Firefox
    &::-moz-focus-inner {
      padding: 0;
      border: 0;
    }
  }

  // Focus state to change chervon icon to black
  .gem-c-accordion__open-all:focus {
    .gem-c-accordion-nav__chevron--stroke {
      stroke: govuk-colour("black");
    }
  }

  .gem-c-accordion__section-heading {
    // Override browser defaults to ensure consistent element height
    @include govuk-font(24);

    margin-top: 0; // Override browser default
    margin-bottom: 0; // Override browser default
  }

  // Section headers have a pointer cursor as an additional affordance
  .gem-c-accordion__section-header {
    position: relative;
    // Safe area on the right to avoid clashing with icon
    padding-right: 40px;
    border-top: $gem-c-accordion-bottom-border-width solid $govuk-border-colour;
    color: $govuk-link-colour;
    cursor: pointer;
  }

  // For devices that can't hover such as touch devices,
  // remove hover state as it can be stuck in that state (iOS).
  @media (hover: none) {
    .gem-c-accordion__section-header:hover {
      border-top-color: $govuk-link-colour;
      box-shadow: inset 0 $gem-c-accordion-border-width 0 0 $govuk-link-colour;
    }
  }

  // Align the arrow icon within the button
  .gem-c-accordion-nav__chevron {
    margin-right: govuk-spacing(1);
    vertical-align: text-top;
    display: inline-block;
  }

  // Buttons within the headers don’t need default styling
  .gem-c-accordion__section-button {

    @include govuk-typography-common;
    margin-top: 0;
    margin-bottom: 0;
    margin-left: 0;
    padding: 0;
    border-width: 0;
    color: $govuk-text-colour;
    background: none;
    text-align: left;
    cursor: pointer;
    -webkit-appearance: none;

    &:active {
      z-index: 1;
      background: govuk-colour("white");
      border-color: $govuk-focus-colour;
      color: $govuk-link-active-colour;
    }

    &:hover {
      color: $govuk-link-hover-colour;
    }

    // Remove default button focus outline in Firefox
    &::-moz-focus-inner {
      padding: 0;
      border: 0;
    }
  }

  .gem-c-accordion__section-button:focus {
    @include govuk-focused-text;

    // Focus state to change the toggle link within individual sections
    .gem-c-accordion__toggle-link {
      color: $govuk-focus-text-colour;
    }

    // Focus state to change chervon icon colour within individual sections
    .gem-c-accordion-nav__chevron--stroke {
      stroke: govuk-colour("black");
    }
  }

  // Extend the touch area of the button to span the section header
  .gem-c-accordion__section-button:after {
    content: "";
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
  }

  .gem-c-accordion__section-button:hover:not(:focus) {
    text-decoration: none;
  }

  // For devices that can't hover such as touch devices,
  // remove hover state as it can be stuck in that state (iOS).
  @media (hover: none) {
    .gem-c-accordion__section-button:hover {
      text-decoration: none;
    }
  }

  // Add toggle link with Chevron icon on left.
  .gem-c-accordion__toggle-link {
    display: block;
    color: $govuk-link-colour;
    text-transform: capitalize;
    margin-top: govuk-spacing(1);
    margin-bottom: govuk-spacing(1);
    @include govuk-font($size: 16, $line-height: 1);

    &:active {
      background: $govuk-link-active-colour;
    }

    &:hover,
    &:focus {
      color: $govuk-link-hover-colour;
    }
  }

  // Change the summary subheading size.
  .gem-c-accordion__section-summary {
    @include govuk-responsive-margin(2, "top");
    @include govuk-responsive-margin(1, "bottom");
    @include govuk-typography-common;
    @include govuk-typography-responsive($size: 19);
  }

  // Hide body of expanded sections
  .gem-c-accordion__section-content {
    display: none;
    @include govuk-responsive-padding(0, "top");
    @include govuk-responsive-padding(6, "bottom");
  }

  // Show the body of expanded sections
  .gem-c-accordion__section--expanded .gem-c-accordion__section-content {
    display: block;
  }

  // Remove the bottom margin from the last item inside the content
  .gem-c-accordion__section-content > :last-child {
    margin-bottom: 0;
  }

  // Reduce the height of the inner content once opened
  .gem-c-accordion__section--expanded .gem-c-accordion__section-header {
    padding-bottom: govuk-spacing(3);
  }

  // Condensed layout
  .gem-c-accordion--condensed {
    .gem-c-accordion__open-all {
      margin-bottom: govuk-spacing(2);
    }

    .gem-c-accordion__section-button {
      @include govuk-typography-responsive($size: 19, $important: true);
    }

    .gem-c-accordion__section-header {
      padding-top: govuk-spacing(2);
      padding-bottom: govuk-spacing(2);
    }

    .gem-c-accordion__section-summary {
      @include govuk-typography-responsive($size: 16, $important: true);
      margin-bottom: govuk-spacing(2);
    }
  }
}
